<html>
<head>
    <title>nycHSdir</title>
	
	<link rel="stylesheet" type="text/css" href="css/jquery-ui.css">
	<link rel="stylesheet" type="text/css" href="css/style.css">
	
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/jquery-ui.js"></script>
    <script src="js/parse.js"></script>
	<script type="text/javascript">
	    $(document).ready(function () {
	        // Construct the catalog query string
	        url = 'http://data.cityofnewyork.us/resource/mreg-rk5p.json?$select=interest_area,selection_method,borough,program_name,dbn&$$app_token=CGxaHQoQlgQSev4zyUh5aR5J3';

	        $.getJSON(url, function (data, textstatus) {
	            //console.log(data);
	            //makeElementText(data, ['interest_area', 'selection_method', 'program_name', 'borough', 'dbn']);
	        });

	        //initialize Parse db. class="doe"
	        Parse.initialize("MtPQsRRglfpClARD9Gskmv7rdkvUaMCHHJ2G90Ri", "QHI0Fuo5IJolPoTAJOw8EqMCjrS6Srk7wSJzwDOC");
	        doedb = Parse.Object.extend("HSProgress");

	        var parseQuery = new Parse.Query(doedb);

	        //parseQuery.select(['college_and_career_readiness_grade', 'postsecondary_enrollment_rate_18months', 'safety_and_respect']);
	        parseQuery.limit(458); //default is 100...

	        parseQuery.find({
	            success: function (parsedb) {
	                makeElementText(parsedb, ['perent_students_with_disabilities', 'percent_ell', 'percent_black_or_hispanic']);
	                //makeElementText(parsedb, ['college_and_career_readiness_grade', 'postsecondary_enrollment_rate_18months', 'safety_and_respect', 'attendance_rate']);
	            }

	        });

	        schoolData = Parse.Object.extend("schoolData");
	        
	        var parseQuery2 = new Parse.Query(schoolData);
	        parseQuery2.containedIn("location_category", ['High school', 'Ungraded', 'K-12 all grades']);
	        //parseQuery2.select(['administrative_district_code', 'geographical_district_code', 'location_category', 'dbn']);

	        parseQuery2.limit(2000); //default is 100...

	        parseQuery2.find({
	            success: function (parsedb) {
	                console.log(parsedb);
	                //makeElementText(parsedb, ['administrative_district_code', 'geographical_district_code', 'dbn']);
	            }

	        });

	    });
	    function makeElementText(data, properties) {
	        var arrays = [];
                $.each(data, function (i, entry) {
                    $.each(properties, function (a, proper) {
                        if (!$.isArray(arrays[a])) arrays[a] = [];
                        if (entry.hasOwnProperty('attributes'))
                        {
                            if ($.inArray(entry.attributes[proper], arrays[a]) == -1) arrays[a].push(entry.attributes[proper]);
                        }
                        else
                        {
                            if ($.inArray(entry[proper], arrays[a]) == -1) arrays[a].push(entry[proper]);
                        }
                    });
                });
                $.each(arrays, function (a, arr) {
                    arr.sort(function (a, b) { return a - b; });
                    console.log(arr);
                    $('div').append('<p><label>' + properties[a] + '</label></p>');
                    $.each(arr, function (j, stuff) {
                        $('div').append('&lt;label&gt;&lt;input type="checkbox" value="' + stuff + '" /&gt;' + stuff + '&lt;/label&gt;</br>');
                        //$('div').append('<option style="font-size:1em;" value="' + stuff + '">' + stuff + '</option>');
                        //$('div').append('&lt;option value="' + stuff + '"&gt;' + stuff + '&lt;/option&gt;</br>');
                    });
                    $('div').append('</br></br>');
                });

            }
</script>	
</head>
	<body>
        <div></div>
	</body>
</html>
