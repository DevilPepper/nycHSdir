<html>
<head>
    <title>nycHSdir</title>
	
	<link rel="stylesheet" type="text/css" href="css/jquery-ui.css">
	<link rel="stylesheet" type="text/css" href="css/style.css">
	
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/jquery-ui.js"></script>
    <script src="js/parse.js"></script>
	<script type="text/javascript">
	    $(document).ready(function () {
	        // Construct the catalog query string
	        url = 'http://data.cityofnewyork.us/resource/mreg-rk5p.json?$select=interest_area,selection_method,borough,program_name&$$app_token=CGxaHQoQlgQSev4zyUh5aR5J3';

	        $.getJSON(url, function (data, textstatus) {
	            //console.log(data);
	            var interest = [];
	            var admissionrq = [];
	            var program = [];
	            var borough = [];
	            var urls;
	            makeElementText(data, [interest, admissionrq, program, borough], ['interest_area', 'selection_method', 'program_name', 'borough']);
	        });

	        //initialize Parse db. class="doe"
	        Parse.initialize("MtPQsRRglfpClARD9Gskmv7rdkvUaMCHHJ2G90Ri", "QHI0Fuo5IJolPoTAJOw8EqMCjrS6Srk7wSJzwDOC");
	        doedb = Parse.Object.extend("doe");

	        var parseQuery = new Parse.Query(doedb);
	        var college = [];
	        var post = [];

	        parseQuery.select(['collegeandcareerreadinessgrade', 'postsecondaryenrollmentrate18months']);
	        parseQuery.limit(458); //default is 100...

	        parseQuery.find({
	            success: function (parsedb) {
	                makeElementText(parsedb, [college, post], ['collegeandcareerreadinessgrade', 'postsecondaryenrollmentrate18months']);
	            }

	        });
	        schoolData = Parse.Object.extend("schoolData");

	        
	        var dist = [];
	        var geo = [];
	        var dbns = [];

	        var q1 = new Parse.Query(schoolData).equalTo('location_category', 'High school');
	        var q2 = new Parse.Query(schoolData).equalTo('location_category', 'Ungraded');
	        var q3 = new Parse.Query(schoolData).equalTo('location_category', 'K-12 all grades');

	        var parseQuery2 = Parse.Query.or(q1, q2, q3);
	        parseQuery2.select(['administrative_district_code', 'geographical_district_code', 'location_category', 'dbn']);

	        parseQuery2.limit(2000); //default is 100...

	        parseQuery2.find({
	            success: function (parsedb) {
	                console.log(parsedb);
	                makeElementText(parsedb, [dist, geo, dbns], ['administrative_district_code', 'geographical_district_code', 'dbn']);
	            }

	        });

	    });
            function makeElementText(data, arrays, properties) {
                $.each(data, function (i, entry) {
                    $.each(arrays, function (a, arr) {
                        if(entry.hasOwnProperty('attributes'))
                        {
                            if ($.inArray(entry.attributes[properties[a]], arr) == -1) arr.push(entry.attributes[properties[a]]);
                        }
                        else
                        {
                            if ($.inArray(entry[properties[a]], arr) == -1) arr.push(entry[properties[a]]);
                        }
                    });
                });
                $.each(arrays, function (a, arr) {
                    arr.sort();
                    console.log(arr);
                    $.each(arr, function (j, stuff) {
                        $('div').append('&lt;label&gt;&lt;input type="checkbox" value="' + stuff + '" /&gt;' + stuff + '&lt;/label&gt;</br>');
                        //$('div').append('<option style="font-size:1em;" value="' + stuff + '">' + stuff + '</option>');
                        //$('div').append('&lt;option value="' + stuff + '"&gt;' + stuff + '&lt;/option&gt;</br>');
                    });
                    $('div').append('</br></br>');
                });
            }

</script>	
</head>
	<body>
        <div></div>
	</body>
</html>
